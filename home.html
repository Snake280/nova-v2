<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nova Store - ุฃูุดุฆ ูุชุฌุฑู ุงูุฅููุชุฑููู</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script>
    tailwind.config = {
        theme: {
            extend: {
                fontFamily: { sans: ['Inter', 'Cairo', 'sans-serif'] },
                // ุฃููุงู ุฎูููุฉ ุฏุงููุฉ ูุฒุฑ ุฑุฆูุณู ุฃุฒุฑู
                colors: { brand: { 500: '#3b82f6', 600: '#2563eb', 700: '#1e40af' } } 
            }
        }
    }
</script>
<style>
/* ุฎูููุฉ ุฏุงููุฉ ูุตูุญุฉ ุงููุจูุท */
body { background-color: #0f172a; color: #f1f5f9; } 
a { transition: all 0.3s ease; }
a:hover { transform: translateY(-2px); color: #60a5fa; }
[v-cloak] { display: none; }

/* ุชุฃุซูุฑ ุงูุงูุชูุงู ููู Modal */
.pop-enter-active, .pop-leave-active { transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
.pop-enter-from, .pop-leave-to { opacity: 0; transform: scale(0.9); }

/* ุชุฃุซูุฑ ุงูุฅุดุนุงุฑุงุช (Toast) */
.toast-enter-active, .toast-leave-active { transition: all 0.4s ease; }
.toast-enter-from { opacity: 0; transform: translateY(-20px); }
.toast-leave-to { opacity: 0; transform: translateY(-20px); }
</style>
</head>
<body>

<div id="app" v-cloak class="min-h-screen flex flex-col">

<header class="sticky top-0 bg-[#1e293b] shadow-lg z-50">
    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
        
        <a href="#home" class="flex items-center">
            <img src="./images/n-logo.png" alt="Nova Logo" class="h-10 w-auto object-contain"> 
        </a>
        
        <nav class="space-x-6 flex items-center">
            <a href="#home" class="text-sm font-semibold hover:text-brand-500">ุงูุฑุฆูุณูุฉ</a>
            <a href="#prices" class="text-sm font-semibold hover:text-brand-500">ุงูุฃุณุนุงุฑ</a>
            <a href="#contact" class="text-sm font-semibold hover:text-brand-500">ุชูุงุตู ูุนูุง</a>
            <a href="#terms" class="text-sm font-semibold hover:text-brand-500">ุงูุดุฑูุท</a>
        </nav>
        
        <div>
            <button v-if="!currentUser" @click="showAuthModal = true; authMode = 'login'" 
                    class="px-4 py-1 border border-brand-500 text-brand-500 rounded hover:bg-brand-500 hover:text-white transition">
                ุชุณุฌูู ุงูุฏุฎูู
            </button>
            <div v-else class="flex items-center space-x-4 space-x-reverse">
                <span class="font-bold text-sm hidden md:block">{{ currentUser.displayName || currentUser.email }}</span>
                <button @click="logout" class="px-3 py-1 bg-red-600 rounded text-white hover:bg-red-700 transition">
                    <i class="fa-solid fa-right-from-bracket"></i> ุฎุฑูุฌ
                </button>
            </div>
        </div>
    </div>
</header>

<section id="home" class="flex-1 flex items-center justify-center text-center py-20">
    <div>
        <h1 class="text-5xl md:text-6xl font-black mb-4">ุงูุทูู ูุญู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ</h1>
        <p class="mb-6 text-gray-400 max-w-xl mx-auto">
            ููุตุฉ Nova Store ุชููุญู ุฃุฏูุงุช Shopify ุงูุงุญุชุฑุงููุฉุ ูุตููุฉ ุฎุตูุตูุง ููุฌุงุญู ูู ุงูุณูู ุงููุญูู.
        </p>
        
        <button v-if="currentUser"
                @click="showNotify('ุฎุทูุชู ุงูุฃููู!', 'ุณูุชู ุชุญูููู ุฅูู ููุญุฉ ุชุญูู ูุชุฌุฑู ุงูุฌุฏูุฏ.')"
                class="px-8 py-3 rounded-full bg-brand-500 hover:bg-brand-600 transition transform hover:-translate-y-1 font-black shadow-lg shadow-brand-500/30">
            ุงุฐูุจ ุฅูู ูุชุฌุฑู <i class="fa-solid fa-arrow-left ml-2"></i>
        </button>

        <button v-else @click="showAuthModal = true; authMode = 'register'"
                class="px-8 py-3 rounded-full bg-brand-500 hover:bg-brand-600 transition transform hover:-translate-y-1 font-black shadow-lg shadow-brand-500/30">
            ุงุจุฏุฃ ุชุฌุฑุจุชู ุงููุฌุงููุฉ
        </button>
    </div>
</section>

<section id="prices" class="py-20 container mx-auto px-6 text-center">
    <h2 class="text-3xl font-black mb-6">ุงูุฃุณุนุงุฑ ูุงูุฎุทุท</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-right">
        
        <div class="p-8 bg-[#1e293b] rounded-xl border-2 border-brand-500/20 shadow-xl">
            <h3 class="text-xl font-black mb-2 text-brand-500">ุงูุฎุทุฉ ุงูุฃุณุงุณูุฉ</h3>
            <p class="text-3xl font-bold mb-6">99 <span class="text-sm text-gray-400">EGP/ุดูุฑ</span></p>
            <ul class="space-y-3 text-gray-300 text-sm">
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ูุชุฌุฑ ูุงุญุฏ</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> 100 ููุชุฌ ูุญุฏ ุฃูุตู</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ุฏุนู ููู ุฃุณุงุณู</li>
                <li class="line-through text-gray-600"><i class="fa-solid fa-xmark ml-2 text-red-500"></i> ุชุญูููุงุช ูุชูุฏูุฉ</li>
            </ul>
        </div>
        
        <div class="p-8 bg-[#1e293b] rounded-xl border-2 border-brand-500 shadow-2xl relative transform scale-105">
            <span class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-brand-500 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider">ุงูุฃูุซุฑ ุดุนุจูุฉ</span>
            <h3 class="text-xl font-black mb-2 text-brand-500">ุงูุฎุทุฉ ุงูุงุญุชุฑุงููุฉ</h3>
            <p class="text-3xl font-bold mb-6">299 <span class="text-sm text-gray-400">EGP/ุดูุฑ</span></p>
            <ul class="space-y-3 text-gray-300 text-sm">
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ุนุฏุฏ ููุชุฌุงุช ุบูุฑ ูุญุฏูุฏ</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ูุทุงู ุฎุงุต ูุฌุงูู (Domain)</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ุชุญูููุงุช ูุชูุฏูุฉ</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ุฏุนู ููู ุนูู ูุฏุงุฑ ุงูุณุงุนุฉ</li>
            </ul>
        </div>
        
        <div class="p-8 bg-[#1e293b] rounded-xl border-2 border-brand-500/20 shadow-xl">
            <h3 class="text-xl font-black mb-2 text-brand-500">ุงูุดุฑูุงุช ุงููุจุฑู</h3>
            <p class="text-3xl font-bold mb-6">ุงุชุตู ุจูุง</p>
            <ul class="space-y-3 text-gray-300 text-sm">
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ูุชุงุฌุฑ ูุชุนุฏุฏุฉ (Multi-Vendor)</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ุชูุงูู API ูุงูู</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ุฎูุงุฏู ูุฎุตุตุฉ</li>
                <li><i class="fa-solid fa-check ml-2 text-green-400"></i> ูุฏูุฑ ุญุณุงุจ ุดุฎุตู</li>
            </ul>
        </div>
    </div>
</section>

<section id="contact" class="py-20 container mx-auto px-6 text-center">
    <h2 class="text-3xl font-black mb-6">ุชูุงุตู ูุนูุง</h2>
    <p class="text-gray-400">ููุงุณุชูุณุงุฑุงุชุ ููููู ุงูุชูุงุตู ูุนูุง:</p>
    <div class="mt-4 text-lg font-bold">
        <p><i class="fa-solid fa-envelope ml-2 text-brand-500"></i> info@nova.com</p>
        <p><i class="fa-solid fa-phone ml-2 text-brand-500"></i> +20 123 456 789</p>
    </div>
</section>

<section id="terms" class="py-20 container mx-auto px-6 text-center">
    <h2 class="text-3xl font-black mb-6">ุงูุดุฑูุท ูุงูุฎุตูุตูุฉ</h2>
    <p class="text-gray-400 max-w-3xl mx-auto">
        ูุญู ููุชุฒููู ุจุญูุงูุฉ ุจูุงูุงุช ุนููุงุฆูุง. ุงุณุชุฎุฏุงูู ููุฐุง ุงููููุน ูุนูู ููุงููุชู ุนูู ุดุฑูุท ุงูุฎุฏูุฉ ูุณูุงุณุฉ ุงูุฎุตูุตูุฉ ุงูุฎุงุตุฉ ุจูุง.
    </p>
</section>

<footer class="bg-[#1e293b] text-gray-400 py-8 text-center mt-auto">
    &copy; 2025 Nova Store. ุฌููุน ุงูุญููู ูุญููุธุฉ.
</footer>

<transition name="pop">
    <div v-if="showAuthModal" @click.self="showAuthModal = false"
         class="fixed inset-0 z-[60] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4 cursor-pointer">
        <div class="bg-gray-800 w-full max-w-md rounded-3xl shadow-2xl p-8 relative cursor-default text-white border border-gray-700">
            <button @click="showAuthModal = false"
                    class="absolute top-5 right-5 w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center hover:bg-red-500 transition">
                <i class="fa-solid fa-times"></i>
            </button>

            <h2 class="text-2xl font-black text-center mb-6">
                {{ authMode==='login' ? 'ูุฑุญุจุงู ุจู' : 'ุงูุถู ุฅูููุง' }}
            </h2>

            <form @submit.prevent="handleAuth" class="space-y-4">
                <input v-model="authForm.email" type="email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" required
                       class="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 outline-none focus:bg-gray-700 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 transition-all duration-200">

                <input v-model="authForm.password" type="password" placeholder="ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู)" required
                       class="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 outline-none focus:bg-gray-700 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 transition-all duration-200">

                <div v-if="authMode==='register'" class="space-y-4">
                    <input v-model="authForm.displayName" type="text" placeholder="ุงุณูู ุงููุงูู" required
                           class="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 outline-none focus:bg-gray-700 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 transition-all duration-200">
                    <input v-model="authForm.storeName" type="text" placeholder="ุงุณู ูุชุฌุฑู (ุณูููู ุดุนุงุฑู)" required
                           class="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 outline-none focus:bg-gray-700 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 transition-all duration-200">
                    <input v-model="authForm.storeActivity" type="text" placeholder="ูุดุงุท ุงููุชุฌุฑ (ูุซู: ุฃุฌูุฒุฉ ุฐููุฉุ ููุงุจุณ)" required
                           class="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 outline-none focus:bg-gray-700 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 transition-all duration-200">
                </div>

                <button type="submit"
                        class="w-full bg-brand-500 text-white py-3.5 rounded-xl font-bold shadow-lg hover:bg-brand-600 transition transform hover:-translate-y-0.5 active:scale-95 duration-200">
                    <span v-if="!loading">{{ authMode==='login' ? 'ุชุณุฌูู ุงูุฏุฎูู' : 'ุฅูุดุงุก ุญุณุงุจ ุงููุชุฌุฑ' }}</span>
                    <i v-else class="fa-solid fa-circle-notch fa-spin"></i>
                </button>
            </form>

            <div class="mt-6 text-center text-sm text-gray-400 border-t border-gray-700 pt-6">
                <button @click="authMode = authMode === 'login' ? 'register' : 'login'"
                        class="text-brand-500 font-bold hover:underline transition duration-200">
                    {{ authMode === 'login' ? 'ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ' : 'ุงูุนูุฏุฉ ูุชุณุฌูู ุงูุฏุฎูู' }}
                </button>
            </div>
        </div>
    </div>
</transition>


<transition name="toast">
<div v-if="notification.show" 
     :class="['fixed top-6 right-6 text-white px-6 py-4 rounded-lg shadow-lg z-50', notification.type === 'error' ? 'bg-red-600' : 'bg-brand-500']">
    <p class="font-bold">{{ notification.title }}</p>
    <p class="text-sm">{{ notification.message }}</p>
</div>
</transition>

</div>

<script>
// โ๏ธ ูุฌุจ ุงุณุชุฎุฏุงู ููุงุชูุญ Firebase ุงูุฎุงุตุฉ ุจู โ๏ธ
const firebaseConfig = {
    apiKey: "AIzaSyAUxHWPtXVUOsmvMWxSN4wyCmGTpSzVFik",
    authDomain: "nova-b91d4.firebaseapp.com",
    databaseURL: "https://nova-b91d4-default-rtdb.firebaseio.com", // **ูุฌุจ ุฃู ูููู ูุฐุง ุตุญูุญุงู**
    projectId: "nova-b91d4",
    storageBucket: "nova-b91d4.appspot.com",
    messagingSenderId: "993960824562",
    appId: "1:993960824562:web:a23cc53cab7adbe2c44a6b"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database(); // ุชุนุฑูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

const { createApp, ref } = Vue;

createApp({
setup() {
    const showAuthModal = ref(false);
    const authMode = ref('login');
    const authForm = ref({ email: '', password: '', displayName: '', storeName: '', storeActivity: '' });
    const currentUser = ref(null);
    const loading = ref(false);
    const notification = ref({ show: false, title: '', message: '', type: 'success' });

    const showNotify = (title, message, type = 'success') => {
        notification.value = { show: true, title, message, type };
        setTimeout(() => notification.value.show = false, 3000);
    };

    auth.onAuthStateChanged(user => { currentUser.value = user; });

    const handleAuth = async () => {
        loading.value = true;
        try {
            if(authMode.value === 'register') {
                
                // 1. ุฅูุดุงุก ุญุณุงุจ Firebase
                const userCredential = await auth.createUserWithEmailAndPassword(authForm.value.email, authForm.value.password);
                const uid = userCredential.user.uid;
                const emailKey = authForm.value.email.replace(/\./g, ','); // ูุชุญููู ุงูุฅูููู ุฅูู ููุชุงุญ ูู Firebase
                
                // 2. ุชุญุฏูุซ ุงูุงุณู ูู ููู ุชุนุฑูู ุงููุณุชุฎุฏู
                await userCredential.user.updateProfile({ displayName: authForm.value.displayName });
                
                // 3. ุฅูุดุงุก ูุชุฌุฑ ุฌุฏูุฏ ูู ูุณุงุฑ /vendors
                const vendorId = `VND_${uid.slice(0, 10)}`; // ID ูุฑูุฏ ูููุชุฌุฑ
                
                // ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ูููุชุฌุฑ (ููุญุฉ ุชุญูู Admin ุณุชุณุญุจูุง ูู ููุง)
                const storeData = {
                    store_info: {
                        logoName: authForm.value.storeName,
                        activity: authForm.value.storeActivity,
                        ownerEmail: authForm.value.email,
                        createdAt: Date.now()
                    },
                    users: {
                        [emailKey]: { 
                            role: 'owner', // ุฃูู ูุณุชุฎุฏู ูู ูุงูู ุงููุชุฌุฑ
                            displayName: authForm.value.displayName
                        }
                    },
                    products: { 'demo_product': { name: 'ููุชุฌ ุชุฌุฑูุจู', price: 100 } }, // ููุชุฌ ุชุฌุฑูุจู ููุจุฏุก
                    orders: {} // ุณุฌู ุงูุทูุจุงุช ูุงุฑุบ
                };

                await db.ref(`vendors/${vendorId}`).set(storeData);

                currentUser.value = userCredential.user;
                showNotify("ุชู ุฅูุดุงุก ูุชุฌุฑู ุจูุฌุงุญ! ๐", `ูุฑุญุจุงู ุจูุ ${authForm.value.displayName}.`);
                showAuthModal.value = false;
                
            } else { // login
                const userCredential = await auth.signInWithEmailAndPassword(authForm.value.email, authForm.value.password);
                currentUser.value = userCredential.user;
                showNotify("ุชู ุชุณุฌูู ุงูุฏุฎูู", `ูุฑุญุจุงู ุจูุ ${userCredential.user.displayName || "ุงููุณุชุฎุฏู"}.`);
                showAuthModal.value = false;
            }
        } catch(e) {
            let msg = "ุญุฏุซ ุฎุทุฃุ ุญุงูู ูุฑุฉ ุฃุฎุฑู.";
            switch(e.code) {
                case "auth/wrong-password": msg="ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ."; break;
                case "auth/user-not-found": msg="ูุฐุง ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ."; break;
                case "auth/invalid-email": msg="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ุตุญูุญ."; break;
                case "auth/email-already-in-use": msg="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ูุณุจูุงู."; break;
                case "auth/weak-password": msg="ูููุฉ ุงููุฑูุฑ ุถุนููุฉุ ูุฌุจ ุฃู ุชููู 6 ุฃุญุฑู ุนูู ุงูุฃูู."; break;
            }
            showNotify("ุฎุทุฃ ูู ุงููุตุงุฏูุฉ", msg, 'error');
        } finally {
            loading.value = false;
        }
    };


    const logout = () => auth.signOut();

    return { 
        showAuthModal, authMode, authForm, currentUser, loading, 
        handleAuth, logout, notification, showNotify 
    };
}
}).mount('#app');
</script>
<script type="module">
import { getUserUID } from "./auth.js";

const goMyStore = document.getElementById("goMyStore");

if (goMyStore) {
    goMyStore.onclick = () => {
        getUserUID(uid => {
            if (uid) {
                window.location.href = `store.html?uid=${uid}`;
            } else {
                alert("ุณุฌูู ุงูุฏุฎูู ุฃููุงู");
            }
        });
    };
}
</script>

</body>
</html>